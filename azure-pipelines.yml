trigger:
- main

pool:
  name: Default  # agente local

variables:
- group: docker-credentials

steps:
- checkout: self

- script: echo "ðŸš€ Build & Push Docker Image desde Azure DevOps"
  displayName: "Inicio del pipeline"

- task: Docker@2
  displayName: 'Login en Docker Hub'
  inputs:
    command: login
    containerRegistry: 'DockerHubService'
  env:
    DOCKERHUB_USERNAME: $(DOCKERHUB_USERNAME)
    DOCKERHUB_TOKEN: $(DOCKERHUB_TOKEN)

- script: |
    docker build -t $(imageName):$(Build.SourceVersion) .
    docker tag $(imageName):$(Build.SourceVersion) $(imageName):latest
  displayName: 'Build Docker image'

- script: |
    docker push $(imageName):$(Build.SourceVersion)
    docker push $(imageName):latest
  displayName: 'Push a Docker Hub'

