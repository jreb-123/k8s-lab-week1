pool:
  name: 'Default'  # tu pool self-hosted

variables:
  imageName: 'jrebaza01/app-week3'
  tag: $(Build.SourceVersion)

steps:
- task: Checkout@1

- task: Docker@2
  displayName: 'Login to Docker Hub'
  inputs:
    command: login
    containerRegistry: 'DockerHubService'
    loginServer: 'https://index.docker.io/v1/'

- task: Docker@2
  displayName: 'Build Docker image'
  inputs:
    command: build
    Dockerfile: '$(Build.SourcesDirectory)\app\Dockerfile'
    tags: '$(imageName):$(tag)'
    buildContext: '$(Build.SourcesDirectory)\app'

- task: Docker@2
  displayName: 'Push Docker image'
  inputs:
    command: push
    tags: '$(imageName):$(tag)'

